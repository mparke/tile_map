// Tile Map: Copyright (c) 2013 Matthew Parke mparke78@gmail.com
!function(){var t=this;var n=function(t){this._data=t||null;this.nodes={n:null,e:null,s:null,w:null}};var i=function(){function t(){return this._data}function n(t){return this._data[t]}function i(t,n){return this._data[t]=n}function e(t){return this.nodes[t]}function s(t,n){return this.nodes[t]=n}function r(){return this.nodes.n}function o(){return this.nodes.e}function u(){return this.nodes.s}function h(){return this.nodes.w}function l(){return this.nodes.e!==null}function f(){return this.nodes.w!==null}function a(){return this.nodes.n!==null}function c(){return this.nodes.s!==null}return function(){this.data=t;this.get=n;this.set=i;this.getNode=e;this.setNode=s;this.hasNext=l;this.next=o;this.hasPrev=f;this.prev=h;this.hasUp=a;this.up=r;this.hasDown=c;this.down=u}}();i.call(n.prototype);var e=function(t,n){this.rootTile=null;if(typeof t==="number"&&t>0){this.matrix=new Matrix(t,n);this.rootTile=this.createTiles()}else{throw new Error("Row size must be greater than 0.")}};var s=function(){function t(){var t=this.matrix.data(),n=t.length,s=this.rootTile,r,o;for(var h=0;h<n;h++){o=t[h];r=i(o);if(s!==null){e(s,r)}s=r}return u(s)}function i(t){var i=t.length,e=0,s=null,r,o;for(var e=0;e<i;e++){o=new n(t[e]);if(s!==null){s.setNode("e",o);o.setNode("w",s)}s=o}return h(o)}function e(t,n){s(t,n);while(t.hasNext()&&n.hasNext()){t=t.next();n=n.next();s(t,n)}}function s(t,n){t.setNode("s",n);n.setNode("n",t)}function r(){return this.rootTile}function o(){return this.matrix.size()}function u(t){t=h(t);t=l(t);return t}function h(t){while(t.hasPrev()){t=t.prev()}return t}function l(t){while(t.hasUp()){t=t.up()}return t}function f(t,n,i){a(t,n,i);while(t.hasNext()){t=t.next();a(t,n,i)}t=h(t);if(t.hasDown()){f(t.down(),n,i)}}function a(t,n,i){if(i){n.call(i,t)}else{n(t)}}function c(t,n){f(this.rootTile,t,n)}function d(t,n){var i=null;f(this.rootTile,function(e){if(n){if(t.call(n,e)){i=e}}else{if(t(e)){i=e}}},this);return i}return function(){this.createTiles=t;this.root=r;this.size=o;this.topLeft=u;this.leftMost=h;this.topMost=l;this.each=c;this.find=d}}();s.call(e.prototype);t.Tile=n;t.TileMap=e}.call(this);